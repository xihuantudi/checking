!function(t){t.fn.__AjaxProxy=function(e){function a(e){var a=t(e).attr("proxy"),r=t(e).attr("href"),o={};return a&&(o=t.parseJSON(a),"string"==t.type(o.callBefore)&&(o.callBefore=new Function("data","return "+o.callBefore)),"string"==t.type(o.callBack)&&(o.callBack=new Function("data",o.callBack))),o.url=r,o}function r(a,r){a.threadLock&&n(r),t.get(a.url,{run:Math.random()},function(o){switch(a.dataType){case"html":a.errorBox?t("#"+a.errorBox).html(o):a.callBack(o);break;case"json":var n=t.parseJSON(o);a.callBack(n),l(n);break;default:alert("不支持的数据格式")}a.threadLock&&setTimeout(function(){c(r)},e.timeInterval)})}function o(e,a){if(e.formId&&"function"==typeof e.formCheckHandler&&!e.formCheckHandler(e.formId))return!1;e.threadLock&&n(a);var r=t("#"+e.formId).serialize();t.post(e.url,r,function(r){switch(e.dataType){case"html":e.errorBox?t("#"+e.errorBox).html(r):e.callBack(r);break;case"json":var o=t.parseJSON(r);e.callBack(o),l(o);break;default:alert("不支持的数据格式")}e.threadLock&&setTimeout(function(){c(a)},e.timeInterval)})}function n(e){try{t(e).button("loading")}catch(a){t(e).attr("disabled",!0)}}function c(e){try{t(e).button("reset")}catch(a){t(e).attr("disabled",!1)}}function l(t){var a=e.location;a&&t.code==e.successCode&&("reload"==a?setTimeout(function(){window.location.reload()},e.callbackDelay):"reset"==a?document.getElementById(e.formId).reset():setTimeout(function(){window.location.replace(a)},e.callbackDelay))}var i={callbackDelay:1e3,threadLock:!0,timeInterval:1e3,errorBox:null,method:"get",dataType:"json",successCode:"000",formId:null,callBefore:function(){return!0},callBack:function(t){try{JDialog.tip.work({type:t.state,content:t.message,timer:e.callbackDelay})}catch(a){alert(t.message)}},formCheckHandler:function(t){return!0}};e=t.extend(i,e),t(this).on("click",function(n){n.stopPropagation();var c=a(this);return e=t.extend(e,c),e.callBefore(t(this).attr("data-content"))?("get"==e.method?r(e,this):o(e,this),!1):!1})},t.fn.AjaxProxy=function(e){t(this).each(function(a,r){t(r).__AjaxProxy(e)})}}(jQuery);